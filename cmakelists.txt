cmake_minimum_required(VERSION 3.16)
set(CMAKE_EXPORT_COMPILE_COMMANDS ON)
set(CMAKE_CXX_STANDARD 20)

#project name
project(yk2)

add_definitions(-D_CRT_SECURE_NO_WARNINGS)

#--------target--------#

include_directories(
    src
    src/platform
    )

set(yk_src  "src/platform/yk_os_win.c" "src/yk_arena.c" "src/yk_math.c")

add_library(${PROJECT_NAME} SHARED ${yk_src}) 

add_executable(yk_test "src/main.c")

target_link_libraries(yk_test yk2)

add_custom_command(
    TARGET yk_test POST_BUILD
    COMMAND ${CMAKE_COMMAND} -E create_symlink
    ${SOURCE_DIR}/res ${BUILD_DIR}/res
    COMMENT "Creating symbolic link to res folder"
)

#----------copy files----------#

#|---compile-commands-|

add_custom_target(
    yk_copy-compile-commands ALL
    COMMAND ${CMAKE_COMMAND} -E copy_if_different
        ${CMAKE_BINARY_DIR}/compile_commands.json
        ${CMAKE_CURRENT_LIST_DIR}
)

#|----------------|

#---------------------#